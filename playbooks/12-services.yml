---
# file: 12-services.yml
- name: Gather facts for services targets
  hosts:
    - homeserver
    - outpost
  tasks:
    - name: Ping these hosts
      ansible.builtin.ping:
- name: Deploy services to the network
  hosts:
    - homeserver
  become: true
  roles:
    - waal70.vaultwarden
    - waal70.authentik
    - waal70.paperless_ngx
    - waal70.homepage
    - waal70.immich
    - waal70.backup

- name: Deploy services to outpost servers
  hosts:
    - outpost
  become: true
  roles:
    - waal70.forgejo
    - waal70.backup
  vars:
    endpoint_idx: 1  # These services will be deployed to the second endpoint (first outpost)
    backup_directories:
      - /appdata
